"use strict";!function(){function e(e,t){function n(){bodyScrollLock.enableBodyScroll(t),t.classList.remove("popup--shown")}Array.prototype.forEach.call(e,function(e){e.addEventListener("click",function(e){e.preventDefault(),bodyScrollLock.disableBodyScroll(t),t.classList.add("popup--shown")})});var o=t.querySelector(".popup__overlay"),c=t.querySelector(".popup__close-btn");o.addEventListener("click",n),c.addEventListener("click",n),document.addEventListener("keydown",function(e){e.keyCode===window.const.keyCode.ESC&&t.classList.contains("popup--shown")&&(e.preventDefault(),n())})}var t=document.querySelector(".comment-popup--add"),n=document.querySelectorAll('[data-target="comment-add"]');if(t||n.length){e(n,t);var o=document.querySelector(".comment-popup--edit"),c=document.querySelectorAll('[data-target="comment-edit"]');if(o||c.length){e(c,o);var r=document.querySelector(".comment-popup--your"),s=document.querySelectorAll('[data-target="comment-your"]');(r||s.length)&&e(s,r)}}}(),function(){var e=document.querySelector(".answers__form");if(e){var t=e.querySelector("#count-answer"),n=document.querySelector(".answers__count");(t||n)&&(n.addEventListener("mouseover",function(){t.focus()}),n.addEventListener("mouseout",function(){t.blur(),n.classList.remove("answers__count--hover")}),t.oninput=function(){t.value=t.value.replace(/[^\+\d]/g,""),t.focus(),n.classList.add("answers__count--hover")})}}(),window.const={keyCode:{ENTER:13,ESC:27},resolution:{DESKTOP:1200,TABLET:768,MOBILE:320}},function(){var e=document.querySelector(".js_cookie"),t=document.querySelector(".js_cookie .js_btn");e&&t&&(document.body.classList.add("page-body--cookie"),t.addEventListener("click",function(){e.classList.add("js_hide"),document.body.classList.remove("page-body--cookie")}))}(),function(){var t=document.querySelector(".filter");if(t){var e=t.querySelector(".filter__open-btn");t.classList.add("filter--js"),e.addEventListener("click",function(e){t.classList.toggle("filter--open"),e.currentTarget.textContent=t.classList.contains("filter--open")?"Скрыть фильтры":"Фильтры"})}}(),function(){function e(e){new SlimSelect({select:e,showSearch:!1,afterClose:function(){t.destroy(document.querySelector(".form-select .ss-list"))},afterOpen:function(){t.init(document.querySelector(".form-select .ss-list"),{continuousScrolling:!1})}})&&t.init(document.querySelector(".form-select .ss-main .ss-content .ss-list"),{continuousScrolling:!1})}var t=window.Scrollbar,n=document.querySelector("#projects-select"),o=document.querySelector("#category-select"),c=document.querySelector("#vote-select");n&&e(n),o&&e(o),c&&e(c)}(),function(){var t=document.querySelector(".gallery-popup");if(t){var e=t.querySelector(".popup__overlay"),n=t.querySelector(".popup__close-btn"),c=t.querySelector(".swiper-container"),r=t.querySelector(".gallery-popup__nav-btn--prev"),s=t.querySelector(".gallery-popup__nav-btn--next"),l=t.querySelector(".gallery-popup__photo-description"),i=t.querySelector(".gallery-popup__counter-current"),a=t.querySelector(".gallery-popup__counter-total"),u=null,o=function(){u.destroy(),c.innerHTML="",bodyScrollLock.enableBodyScroll(t),t.classList.remove("popup--shown")};e.addEventListener("click",o),n.addEventListener("click",o),document.addEventListener("click",function(e){e.target.classList.contains("gallery__item-link")&&(e.preventDefault(),bodyScrollLock.disableBodyScroll(t),t.classList.add("popup--shown"),function(e){var t=e.parentElement.parentElement.children,n=e.querySelector(".gallery__item-text"),o=document.createElement("div");o.classList.add("swiper-wrapper"),Array.prototype.forEach.call(t,function(e){var t=e.querySelector(".gallery__item").cloneNode(!0);t.classList.add("swiper-slide"),o.appendChild(t)}),c.appendChild(o),u=new Swiper(c,{initialSlide:+e.dataset.index,slidesPerView:1,watchOverflow:!0,grabCursor:!0,loop:!0,navigation:{prevEl:r,nextEl:s},on:{slideChange:function(){l.textContent=t[this.realIndex].querySelector(".gallery__item-text").textContent,i.textContent=+this.realIndex+1}}}),l.textContent=n.textContent,i.textContent=+e.dataset.index+1,a.textContent=t.length}(e.target))}),document.addEventListener("keydown",function(e){e.keyCode===window.const.keyCode.ESC&&t.classList.contains("popup--shown")&&(e.preventDefault(),o())})}}(),function(){var e=document.querySelectorAll(".gallery");e.length&&e.forEach(function(e){e.querySelectorAll(".gallery__item-link").forEach(function(e,t){e.dataset.index=t}),new Swiper(e,{slidesPerView:"auto",spaceBetween:16,breakpoints:{320:{spaceBetween:12}},watchOverflow:!0,grabCursor:!0})})}(),function(){var e=document.querySelector(".location-switcher");e&&e.classList.add("location-switcher--js")}(),function(){var e=document.querySelector(".page-header");if(e){var t=document.documentElement.clientWidth,n=e.querySelector(".page-header__bar"),o=e.querySelector(".main-menu"),c=o.querySelector(".container"),r=e.querySelector(".menu-btn"),s=r.querySelector(".menu-btn__text"),l=function(){o.style.height=e.classList.contains("page-header--open-menu")&&document.documentElement.clientWidth<window.const.resolution.DESKTOP?window.innerHeight-n.offsetHeight+"px":""},i=function(){e.classList.remove("page-header--open-menu"),bodyScrollLock.enableBodyScroll(c),r.classList.remove("menu-btn--close"),s.textContent="Открыть основное меню"};r.addEventListener("click",function(){e.classList.contains("page-header--open-menu")?i():(e.classList.add("page-header--open-menu"),bodyScrollLock.disableBodyScroll(c),r.classList.add("menu-btn--close"),s.textContent="Закрыть основное меню"),l()}),window.addEventListener("resize",function(){t!==document.documentElement.clientWidth&&(t=document.documentElement.clientWidth,i()),l()})}}(),function(){var e=document.querySelector(".page-header");if(e){var t=function(){0<window.pageYOffset?e.classList.add("page-header--above-content"):e.classList.remove("page-header--above-content")},n=function(){document.body.style.paddingTop=e.offsetHeight+"px"};e.classList.add("page-header--js"),n(),t(),document.addEventListener("scroll",t),window.addEventListener("resize",function(){e.classList.remove("page-header--above-content"),n(),t()})}}(),function(){var e=document.querySelector(".project-page__panel");e&&(e.classList.add("project-page__panel--js"),new Sticky(".project-page__panel"))}(),function(){var e=document.querySelectorAll(".project-page__text");if(e.length){var t=document.documentElement.clientWidth,n=!1,o=function(e){e.target.classList.contains("project-page__text-btn")&&function(e){var t=e.parentElement,n=t.querySelector(".project-page__text-container"),o=e.querySelector(".project-page__text-btn-caption");t.classList.toggle("project-page__text--collapsed"),t.classList.contains("project-page__text--collapsed")?(n.style.height="190px",o.textContent="Показать полностью"):(n.style.height=n.scrollHeight+"px",o.textContent="Скрыть")}(e.target)},c=function(){Array.prototype.forEach.call(e,function(e){var t=e.querySelector(".project-page__text-container");190<t.scrollHeight&&(e.classList.add("project-page__text--collapsed","project-page__text--js"),t.style.height="190px")}),document.addEventListener("click",o),n=!0};t<window.const.resolution.TABLET&&c(),window.addEventListener("resize",function(){if(t!==document.documentElement.clientWidth)if((t=document.documentElement.clientWidth)<window.const.resolution.TABLET){if(n)return;c()}else Array.prototype.forEach.call(e,function(e){var t=e.querySelector(".project-page__text-container"),n=e.querySelector(".project-page__text-btn-caption");e.classList.remove("project-page__text--collapsed","project-page__text--js"),t.style.height="",n.textContent="Показать полностью"}),document.removeEventListener("click",o),n=!1})}}(),function(){var t=document.querySelector(".project-vote"),n=document.querySelector(".vote-popup");if(t&&n){var o=t.querySelector(".project-vote__submit-form form"),e=t.querySelector(".project-vote__revoke-btn"),c=n.querySelector(".vote-popup__revoke-btn"),r=null,s=+t.querySelector(".vote-results__value--approve").textContent.replace(/\s+/g,""),l=+t.querySelector(".vote-results__value--reject").textContent.replace(/\s+/g,""),i=t.querySelector(".vote-results__indicator"),a=function(e){e.preventDefault(),t.classList.remove("project-vote--voted"),o.querySelector(".project-vote__vote-btn--selected").classList.remove("project-vote__vote-btn--selected"),o.reset(),n.classList.remove("vote-popup--shown"),clearTimeout(r)};t.classList.add("project-vote--js"),i.style.width=Math.trunc(s/(s+l)*100)+"%",o.addEventListener("click",function(e){e.target.classList.contains("project-vote__vote-btn")&&!e.target.classList.contains("project-vote__vote-btn--selected")&&(t.classList.add("project-vote--voted"),e.target.classList.add("project-vote__vote-btn--selected"),t.querySelector("input").dispatchEvent(new Event("change")),n.classList.add("vote-popup--shown"),r=setTimeout(function(){n.classList.remove("vote-popup--shown")},5e3))}),e.addEventListener("click",a),c.addEventListener("click",a)}}(),function(){var e=document.querySelector(".projects-list");if(e){var t=new Ellipsis({lines:3}),n=e.querySelectorAll(".project-item__title");t.add(n)}}(),function(){var c=document.getElementById("poll-range");c&&(noUiSlider.create(c,{start:[5],behaviour:"snap",connect:"lower",step:1,range:{min:[1],max:[10]},pips:{mode:"steps",stepped:!0,density:4},tooltips:!0,format:wNumb({decimals:0})}),c.noUiSlider.on("update",function(e){var t=Math.max(e),n=c.querySelectorAll(".noUi-marker-horizontal.noUi-marker-sub");if(n)for(var o=0;o<n.length;o++)o<=t-2?n[o].classList.add("form-range__accent"):n[o].classList.remove("form-range__accent")}))}(),function(){var n="js_hide",e=document.querySelector(".js_short_list"),t=document.querySelector(".js_short_list + .js_show_all");if(e&&t){var o=e.querySelectorAll("li");o.forEach(function(e,t){4<t&&e.classList.add(n)}),t.addEventListener("click",function(){o.forEach(function(e){e.classList.remove(n),t.classList.add(n)})})}}(),function(){var t="js-hide",n=document.querySelector(".special-popup"),e=document.querySelectorAll(".js-open-popup");if(n&&e){var o=n.querySelector(".js-close-popup");n.querySelectorAll(".special-popup__list").forEach(function(e){var n=e.querySelectorAll("button");n.forEach(function(t){t.addEventListener("click",function(e){e.preventDefault(),n.forEach(function(e){e.classList.remove("active")}),t.classList.add("active")})})}),e.forEach(function(e){e.addEventListener("click",function(e){e.preventDefault(),n.classList.remove(t)})}),o.addEventListener("click",function(){n.classList.add(t)}),window.addEventListener("keydown",function(e){e.keyCode===window.const.keyCode.ESC&&(e.preventDefault(),n.classList.add(t))})}}(),function(){var t=document.querySelector(".social__link--subscribe, .social__link--unsubscribe");if(t){t.addEventListener("click",function(e){e.preventDefault(),t.classList.contains("social__link--subscribe")?(t.textContent="Отписаться",t.classList.remove("social__link--subscribe"),t.classList.add("social__link--unsubscribe")):(t.textContent="Подписаться",t.classList.add("social__link--subscribe"),t.classList.remove("social__link--unsubscribe"))})}}(),function(){var e=document.querySelectorAll(".text-hidden");e.length&&Array.prototype.forEach.call(e,function(e){var t=e.querySelector(".text-hidden__btn"),n=e.querySelector(".text-hidden__btn span"),o=e.querySelector(".text-hidden__container"),c=e.querySelector(".answers__button-wrapper");(t||o||c)&&t.addEventListener("click",function(e){e.preventDefault(),t.classList.toggle("text-hidden__btn--open"),o.classList.toggle("text-hidden__container--open"),c.classList.toggle("answers__button-wrapper--open"),n.textContent="Развернуть"===n.textContent?"Свернуть":"Развернуть"})})}(),function(){var e=document.querySelector(".page-body__up-btn"),t=document.querySelector("footer .container");if(e){if(t){var n=function(){t.getBoundingClientRect().right+e.offsetWidth<document.documentElement.clientWidth?(e.style.left=t.getBoundingClientRect().right-parseInt(getComputedStyle(t).paddingRight,10)+16+"px",e.style.right=""):(e.style.left="",e.style.right="16px")};n(),window.addEventListener("resize",function(){n()})}e.addEventListener("click",function(e){e.preventDefault(),window.scrollTo({top:0,behavior:"smooth"})})}}(),function(){var e=document.querySelector(".user-menu");if(e){var t=e.querySelector(".user-menu__dropdown-btn"),n=t.querySelector(".user-menu__dropdown-btn-text"),o=e.querySelector(".user-menu__overlay"),c=e.querySelector(".user-menu__list"),r=function(){e.classList.remove("user-menu--open"),o.classList.remove("user-menu__overlay--shown"),n.textContent="Открыть меню пользователя"};t.addEventListener("click",function(){e.classList.contains("user-menu--open")?(r(),c.style.height=""):(e.classList.add("user-menu--open"),o.classList.add("user-menu__overlay--shown"),n.textContent="Закрыть меню пользователя",c.style.height=c.scrollHeight+"px")}),o.addEventListener("click",r),document.addEventListener("keydown",function(e){e.keyCode===window.const.keyCode.ESC&&o.classList.contains("user-menu__overlay--shown")&&(e.preventDefault(),r())})}}();