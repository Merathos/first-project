"use strict";!function(){function e(e,o){Array.prototype.forEach.call(e,function(e){e.addEventListener("click",function(e){e.preventDefault(),window.openPopup(o);var t=o.querySelectorAll(".js-text-hidden");t.length&&window.openText(t)})})}var t=document.querySelector(".js-comment-popup--add"),o=document.querySelectorAll(".js-comment-add");t&&o.length&&e(o,t);var n=document.querySelector(".js-comment-popup--edit"),c=document.querySelectorAll(".js-comment-edit");n&&c.length&&e(c,n);var r=document.querySelector(".js-comment-popup--your"),s=document.querySelectorAll(".js-comment-your");r&&s.length&&e(s,r);var l=document.querySelector(".js-table-popup"),i=document.querySelectorAll(".js-table");l&&i.length&&e(i,l);var a=document.querySelector(".js-comment-popup--table"),d=document.querySelectorAll(".js-comment-table");a&&d.length&&e(d,a)}(),function(){var e=document.querySelector(".js-answers__form");if(e){var t=e.querySelector(".js-count-answer"),o=document.querySelector(".js-answers__count"),n=document.querySelector(".js-answers__all-count");(t||o||n)&&(o.addEventListener("mouseover",function(){t.focus()}),t.onblur=function(){t.value<1?t.value=1:t.value>+n.textContent&&(t.value=+n.textContent),o.classList.remove("answers__count--hover")},t.onfocus=function(){o.classList.add("answers__count--hover")},t.oninput=function(){t.value=t.value.replace(/[^\+\d]/g,""),t.focus(),o.classList.add("answers__count--hover")},e.addEventListener("submit",function(e){e.preventDefault(),t.blur()}))}}(),window.const={keyCode:{ENTER:13,ESC:27},resolution:{DESKTOP:1200,TABLET:768,MOBILE:320}},function(){var e=document.querySelector(".js_cookie"),t=document.querySelector(".js-cookie__button");e&&t&&(document.body.classList.add("page-body--cookie"),t.addEventListener("click",function(){e.classList.add("js_hide"),document.body.classList.remove("page-body--cookie")}))}(),function(){if(document.querySelector(".js-filter-vote")){new window.SlimSelect({select:".js-filter-vote select",showSearch:!1,allowDeselect:!0,placeholder:"Голосовал",deselectLabel:'<button type="button"><span class="visually-hidden">Сбросить фильтр по голосам</span><svg width="12" height="12" viewBox="0 0 12 12"><path d="M1 1L11 11M11 1L1 11" stroke-width="2"/></svg></button>'})}}(),function(){var t=document.querySelector(".js-filter");if(t){var e=t.querySelector(".js-filter__open-btn");t.classList.add("filter--js"),e.addEventListener("click",function(e){t.classList.toggle("filter--open"),e.currentTarget.textContent=t.classList.contains("filter--open")?"Скрыть фильтры":"Фильтры"})}}(),function(){function e(e){new window.SlimSelect({select:e,showSearch:!1,afterClose:function(){t.destroy(document.querySelector(".form-select .ss-list"))},afterOpen:function(){t.init(document.querySelector(".form-select .ss-list"),{continuousScrolling:!1})}})&&t.init(document.querySelector(".form-select .ss-main .ss-content .ss-list"),{continuousScrolling:!1})}var t=window.Scrollbar,o=document.querySelector("#projects-select"),n=document.querySelector("#category-select");o&&e(o),n&&e(n)}(),function(){var t=document.querySelector(".js-gallery-popup");if(t){var c=t.querySelector(".js-gallery-popup__frame"),r=t.querySelector(".js-gallery-popup__nav-btn--prev"),s=t.querySelector(".js-gallery-popup__nav-btn--next"),l=t.querySelector(".js-gallery-popup__photo-description"),i=t.querySelector(".js-gallery-popup__counter-current"),a=t.querySelector(".js-gallery-popup__counter-total"),d=null;document.addEventListener("click",function(e){e.target.classList.contains("js-gallery__item-link")&&(e.preventDefault(),d&&(d.destroy(),c.innerHTML=""),window.openPopup(t),function(e){var t=e.parentElement.parentElement.children,o=e.querySelector(".gallery__item-text"),n=document.createElement("div");n.classList.add("swiper-wrapper"),Array.prototype.forEach.call(t,function(e){var t=e.querySelector(".gallery__item").cloneNode(!0);t.classList.add("swiper-slide"),n.appendChild(t)}),c.appendChild(n),d=new window.Swiper(c,{initialSlide:+e.dataset.index,slidesPerView:1,watchOverflow:!0,grabCursor:!0,loop:!0,navigation:{prevEl:r,nextEl:s},on:{slideChange:function(){l.textContent=t[this.realIndex].querySelector(".gallery__item-text").textContent,i.textContent=+this.realIndex+1}}}),l.textContent=o.textContent,i.textContent=+e.dataset.index+1,a.textContent=t.length}(e.target))})}}(),function(){var e=document.querySelectorAll(".js-gallery");if(e.length){e.forEach(function(e){e.querySelectorAll(".js-gallery__item-link").forEach(function(e,t){e.dataset.index=t}),function(e){new window.Swiper(e,{slidesPerView:"auto",spaceBetween:16,breakpoints:{320:{spaceBetween:12}},watchOverflow:!0,grabCursor:!0})}(e)})}}(),function(){var e=document.querySelector(".js-location-switcher");e&&e.classList.add("location-switcher--js")}(),function(){var e=document.querySelector(".js-page-header");if(e){var t=document.documentElement.clientWidth,o=e.querySelector(".js-page-header__bar"),n=e.querySelector(".js-main-menu"),c=n.querySelector(".container"),r=e.querySelector(".js-menu-btn"),s=r.querySelector(".menu-btn__text"),l=document.querySelectorAll(".js-open-popup"),i=function(){n.style.height=e.classList.contains("page-header--open-menu")&&document.documentElement.clientWidth<window.const.resolution.DESKTOP?window.innerHeight-o.offsetHeight+"px":""},a=function(){e.classList.remove("page-header--open-menu"),window.bodyScrollLock.enableBodyScroll(c),r.classList.remove("menu-btn--close"),s.textContent="Открыть основное меню",window.adjustPageContentTopPadding()};r.addEventListener("click",function(){e.classList.contains("page-header--open-menu")?a():(e.classList.add("page-header--open-menu"),window.bodyScrollLock.disableBodyScroll(c),r.classList.add("menu-btn--close"),s.textContent="Закрыть основное меню"),i()}),l.forEach(function(e){e.addEventListener("click",a)}),window.addEventListener("resize",function(){t!==document.documentElement.clientWidth&&(t=document.documentElement.clientWidth,a()),i()})}}(),function(){var e=document.querySelector(".js-page-header");if(e){var t=e.querySelector(".js-page-header__bar"),o=function(){document.documentElement.clientWidth>=window.const.resolution.DESKTOP&&0<window.pageYOffset?(e.classList.add("page-header--above-content"),e.style.top=-t.offsetHeight+"px"):(e.classList.remove("page-header--above-content"),e.style.top=0)},n=function(){document.body.style.paddingTop=e.offsetHeight+"px"};e.classList.add("page-header--js"),n(),o(),document.addEventListener("scroll",o),window.addEventListener("resize",function(){e.classList.remove("page-header--above-content"),n(),o()}),window.adjustPageContentTopPadding=n}}(),function(){var e=document.querySelectorAll(".js-popup");window.openPopup=function(e){window.bodyScrollLock.disableBodyScroll(e),e.classList.add("popup--shown")};function n(e){window.bodyScrollLock.enableBodyScroll(e),e.classList.remove("popup--shown")}e.forEach(function(t){var e=t.querySelector(".js-popup__overlay"),o=t.querySelector(".js-popup__close-btn");e.addEventListener("click",function(){n(t)}),o.addEventListener("click",function(){n(t)}),document.addEventListener("keydown",function(e){!function(e,t){e.keyCode===window.const.keyCode.ESC&&t.classList.contains("popup--shown")&&(e.preventDefault(),n(t))}(e,t)})})}(),function(){var e=document.querySelector(".js-project-page__panel");e&&(e.classList.add("project-page__panel--js"),new window.Sticky(".js-project-page__panel"))}(),function(){var e=document.querySelectorAll(".js-project-page__text");if(e.length){var t=document.documentElement.clientWidth,o=!1,n=function(e){e.target.classList.contains("js-project-page__text-btn")&&function(e){var t=e.parentElement,o=t.querySelector(".project-page__text-container"),n=e.querySelector(".project-page__text-btn-caption");t.classList.toggle("project-page__text--collapsed"),t.classList.contains("project-page__text--collapsed")?(o.style.height="190px",n.textContent="Показать полностью"):(o.style.height=o.scrollHeight+"px",n.textContent="Скрыть")}(e.target)},c=function(){Array.prototype.forEach.call(e,function(e){var t=e.querySelector(".project-page__text-container");190<t.scrollHeight&&(e.classList.add("project-page__text--collapsed","project-page__text--js"),t.style.height="190px")}),document.addEventListener("click",n),o=!0};t<window.const.resolution.TABLET&&c(),window.addEventListener("resize",function(){if(t!==document.documentElement.clientWidth)if((t=document.documentElement.clientWidth)<window.const.resolution.TABLET){if(o)return;c()}else Array.prototype.forEach.call(e,function(e){var t=e.querySelector(".project-page__text-container"),o=e.querySelector(".project-page__text-btn-caption");e.classList.remove("project-page__text--collapsed","project-page__text--js"),t.style.height="",o.textContent="Показать полностью"}),document.removeEventListener("click",n),o=!1})}}(),function(){var t=document.querySelector(".js-project-vote"),o=document.querySelector(".js-vote-popup");if(t&&o){var n=t.querySelector(".js-project-vote__submit-form form"),e=t.querySelector(".js-project-vote__revoke-btn"),c=o.querySelector(".js-vote-popup__revoke-btn"),r=null,s=+t.querySelector(".js-vote-results__value--approve").textContent.replace(/\s+/g,""),l=+t.querySelector(".js-vote-results__value--reject").textContent.replace(/\s+/g,""),i=t.querySelector(".js-vote-results__indicator"),a=function(e){e.preventDefault(),t.classList.remove("project-vote--voted"),n.querySelector(".project-vote__vote-btn--selected").classList.remove("project-vote__vote-btn--selected"),n.reset(),o.classList.remove("vote-popup--shown"),clearTimeout(r)};t.classList.add("project-vote--js"),i.style.width=Math.trunc(s/(s+l)*100)+"%",n.addEventListener("click",function(e){e.target.classList.contains("project-vote__vote-btn")&&!e.target.classList.contains("project-vote__vote-btn--selected")&&(t.classList.add("project-vote--voted"),e.target.classList.add("project-vote__vote-btn--selected"),t.querySelector("input").dispatchEvent(new Event("change")),o.classList.add("vote-popup--shown"),r=setTimeout(function(){o.classList.remove("vote-popup--shown")},5e3))}),e.addEventListener("click",a),c.addEventListener("click",a)}}(),function(){var e=document.querySelector(".js-projects-list");if(e){var t=new window.Ellipsis({lines:3}),o=e.querySelectorAll(".project-item__title");t.add(o)}}(),function(){var c=document.querySelector(".js-poll-range");c&&(window.noUiSlider.create(c,{start:[5],behaviour:"snap",connect:"lower",step:1,range:{min:[1],max:[10]},pips:{mode:"steps",stepped:!0,density:4},tooltips:!0,format:window.wNumb({decimals:0})}),c.noUiSlider.on("update",function(e){var t=Math.max(e),o=c.querySelectorAll(".noUi-marker-horizontal.noUi-marker-sub");if(o)for(var n=0;n<o.length;n++)n<=t-2?o[n].classList.add("form-range__accent"):o[n].classList.remove("form-range__accent")}))}(),function(){var o="js_hide",e=document.querySelector(".js_short_list"),t=document.querySelector(".js_short_list + .js_show_all");if(e&&t){var n=e.querySelectorAll("li");n.forEach(function(e,t){4<t&&e.classList.add(o)}),t.addEventListener("click",function(){n.forEach(function(e){e.classList.remove(o),t.classList.add(o)})})}}(),function(){var t="js-hide",o=document.querySelector(".special-popup"),e=document.querySelectorAll(".js-open-popup");if(o&&e){var n=document.documentElement,c={"font-size":!0,"font-family":!0,theme:!0},r=o.querySelector(".js-close-popup"),s=o.querySelectorAll("[data-property]"),l=o.querySelector(".js-special-popup__reset");s.forEach(function(e){e.addEventListener("click",function(e){e.preventDefault();var t="[data-property="+e.target.getAttribute("data-property")+"]";o.querySelectorAll(t).forEach(function(e){e.classList.remove("active")}),e.target.classList.add("active"),function(e){var t=e.dataset.property,o=e.dataset.value;n.classList.forEach(function(e){new RegExp(t).test(e)&&n.classList.remove(e)}),"default"!==o?(c[t]=!1,n.classList.add("mod-"+t+"-"+o)):c[t]=!0,"font-size"===t&&window.adjustPageContentTopPadding(),l.disabled=c["font-size"]&&c["font-family"]&&c.theme}(e.currentTarget)})}),l.addEventListener("click",function(){n.className.split(" ").forEach(function(e){-1!==e.indexOf("mod-")&&n.classList.remove(e)}),s.forEach(function(e){e.classList.toggle("active","default"===e.dataset.value)}),l.disabled=!0}),e.forEach(function(e){e.addEventListener("click",function(e){e.preventDefault(),o.classList.remove(t),n.clientWidth<window.const.resolution.DESKTOP&&window.bodyScrollLock.disableBodyScroll(o)})}),r.addEventListener("click",function(){o.classList.add(t),n.clientWidth<window.const.resolution.DESKTOP&&window.bodyScrollLock.enableBodyScroll(o)}),window.addEventListener("keydown",function(e){e.keyCode===window.const.keyCode.ESC&&(e.preventDefault(),o.classList.add(t),n.clientWidth<window.const.resolution.DESKTOP&&window.bodyScrollLock.enableBodyScroll(o))})}}(),function(){var t=document.querySelector(".js-social__link--subscribe, .js-social__link--unsubscribe");if(t){var o=t.querySelector(".social__link-text");t.addEventListener("click",function(e){e.preventDefault(),t.classList.contains("social__link--subscribe")?(o.textContent="Отписаться",t.classList.remove("social__link--subscribe"),t.classList.add("social__link--unsubscribe")):(o.textContent="Подписаться",t.classList.add("social__link--subscribe"),t.classList.remove("social__link--unsubscribe"))})}}(),function(){var e=document.querySelectorAll(".table-fixed");if(e.length){Array.prototype.forEach.call(e,function(e){return new window.SimpleBar(e,{autoHide:!1})})}}(),function(){var e=document.querySelectorAll(".table-fixed tbody");if(e.length){Array.prototype.forEach.call(e,function(e){return new window.SimpleBar(e,{autoHide:!1})})}}(),function(){var e=document.querySelector(".table-fixed--all-screen table tbody .simplebar-content-wrapper"),t=document.querySelector(".table-fixed--all-screen table tr:first-child");(e||t)&&e.addEventListener("scroll",function(){50<e.scrollTop&&t.classList.add("table-fixed__header--scroll"),e.scrollTop<50&&t.classList.remove("table-fixed__header--scroll")})}(),function(){var e=document.documentElement.clientWidth,t=document.querySelector(".activity-tabs__list");if(t){var o=t.querySelector(".activity-tabs__item--active");if(o){var n=o.offsetLeft;e<window.const.resolution.TABLET&&(t.scrollLeft=n-16)}}}(),function(){window.openText=function(e){Array.prototype.forEach.call(e,function(e){var t=e.querySelector(".js-text-hidden__btn"),o=t.querySelector("span"),n=e.querySelector(".text-hidden__container"),c=e.querySelector(".text-hidden__btn-wrapper");(t||n||c)&&(54<n.scrollHeight?(n.classList.add("text-hidden__container--close"),t.addEventListener("click",function(e){e.preventDefault(),t.classList.toggle("text-hidden__btn--open"),n.classList.toggle("text-hidden__container--close"),c.classList.toggle("text-hidden__btn-wrapper--open"),o.textContent="Развернуть"===o.textContent?"Свернуть":"Развернуть"})):c.classList.add("text-hidden__btn-wrapper--hidden"))})};var e=document.querySelectorAll(".answers__discussion-col.js-text-hidden");e.length&&window.openText(e)}(),function(){var n=document.querySelector(".js-page-body__up-btn"),e=document.querySelector("footer .container");if(n){var c=document.querySelector(".js-cookie__button");if(e){var t=function(){e.getBoundingClientRect().right+n.offsetWidth<document.documentElement.clientWidth?(n.style.left=e.getBoundingClientRect().right-parseInt(getComputedStyle(e).paddingRight,10)+16+"px",n.style.right=""):(n.style.left="",n.style.right="16px"),c&&(n.style.bottom=window.innerHeight-c.getBoundingClientRect().bottom+"px")};t(),window.addEventListener("resize",function(){t()})}n.addEventListener("click",function(e){e.preventDefault(),window.scrollTo({top:0,behavior:"smooth"})}),document.addEventListener("click",function(e){if((e.target.classList.contains("js-special-popup__btn-size")||e.target.classList.contains("js-special-popup__reset"))&&c){var t=c.offsetHeight,o=window.innerHeight-c.getBoundingClientRect().bottom;n.style.height=t+"px",n.style.width=t+"px",n.style.bottom=o+"px"}})}}(),function(){var e=document.querySelector(".js-user-menu");if(e){var t=e.querySelector(".js-user-menu__dropdown-btn"),o=t.querySelector(".user-menu__dropdown-btn-text"),n=e.querySelector(".js-user-menu__overlay"),c=e.querySelector(".js-user-menu__list"),r=function(){e.classList.remove("user-menu--open"),n.classList.remove("user-menu__overlay--shown"),o.textContent="Открыть меню пользователя"};t.addEventListener("click",function(){e.classList.contains("user-menu--open")?(r(),c.style.height=""):(e.classList.add("user-menu--open"),n.classList.add("user-menu__overlay--shown"),o.textContent="Закрыть меню пользователя",c.style.height=c.scrollHeight+"px")}),n.addEventListener("click",r),document.addEventListener("keydown",function(e){e.keyCode===window.const.keyCode.ESC&&n.classList.contains("user-menu__overlay--shown")&&(e.preventDefault(),r())})}}();